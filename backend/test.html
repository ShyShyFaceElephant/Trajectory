<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>API æ¸¬è©¦é é¢</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        button { margin: 5px 0; }
        input, textarea { width: 100%; margin-bottom: 10px; }
        img { max-width: 300px; display: block; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>API æ¸¬è©¦ä»‹é¢</h1>

    <h2>ğŸ” ç®¡ç†å“¡è¨»å†Š</h2>
    <input type="text" id="manager_id" placeholder="é†«ç”Ÿ ID">
    <input type="text" id="manager_pwd" placeholder="å¯†ç¢¼">
    <input type="text" id="manager_name" placeholder="å§“å">
    <input type="text" id="manager_dept" placeholder="ç§‘åˆ¥">
    <input type="file" id="manager_img">
    <button onclick="managerSignup()">è¨»å†Šç®¡ç†å“¡</button>

    <h2>ğŸ”‘ ç®¡ç†å“¡ç™»å…¥</h2>
    <input type="text" id="login_manager_id" placeholder="é†«ç”Ÿ ID">
    <input type="text" id="login_manager_pwd" placeholder="å¯†ç¢¼">
    <button onclick="managerLogin()">ç™»å…¥ç®¡ç†å“¡</button>
    <p><strong>Token:</strong> <span id="manager_token"></span></p>

    <h2>ğŸ§‘â€âš•ï¸ å–å¾—é†«ç”Ÿè³‡è¨Š</h2>
    <button onclick="getManagerInfo()">æŸ¥è©¢é†«ç”Ÿè³‡è¨Š</button>
    <pre id="manager_info"></pre>

    <h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ æœƒå“¡è¨»å†Š</h2>
    <input type="text" id="member_id" placeholder="èº«ä»½è­‰å­—è™Ÿ">
    <input type="text" id="member_sex" placeholder="æ€§åˆ¥ M æˆ– F">
    <input type="text" id="member_name" placeholder="å§“å">
    <input type="text" id="member_birthdate" placeholder="å‡ºç”Ÿæ—¥æœŸ (YYYYMMDD)">
    <input type="file" id="member_img">
    <button onclick="memberSignup()">è¨»å†Šæˆå“¡</button>

    <h2>ğŸ“‹ æˆå“¡åˆ—è¡¨</h2>
    <button onclick="getMemberList()">å–å¾—æˆå“¡åˆ—è¡¨</button>
    <pre id="member_list"></pre>

    <h2>ğŸ–¼ï¸ åœ–ç‰‡æ¸¬è©¦</h2>
    <input type="text" id="img_member_id" placeholder="æœƒå“¡ ID">
    <button onclick="getMemberImage()">è¼‰å…¥æœƒå“¡å€‹äººç…§</button>
    <img id="member_image" src="" alt="æœƒå“¡å€‹äººç…§">
    <br>
    <input type="text" id="img_manager_id" placeholder="é†«ç”Ÿ ID">
    <button onclick="getManagerImage()">è¼‰å…¥é†«ç”Ÿå€‹äººç…§</button>
    <img id="manager_image" src="" alt="é†«ç”Ÿå€‹äººç…§">

    <script>
        const BASE_URL = "http://localhost:8000";

        let managerToken = "";

        async function managerSignup() {
            const form = new FormData();
            form.append("id", document.getElementById("manager_id").value);
            form.append("password", document.getElementById("manager_pwd").value);
            form.append("department", document.getElementById("manager_dept").value);
            form.append("name", document.getElementById("manager_name").value);
            form.append("profile_image_file", document.getElementById("manager_img").files[0]);

            const res = await fetch(`${BASE_URL}/manager/Manager_Signup`, { method: "POST", body: form });
            alert(await res.text());
        }

        async function managerLogin() {
            const id = document.getElementById("login_manager_id").value;
            const password = document.getElementById("login_manager_pwd").value;

            const res = await fetch(`${BASE_URL}/manager/Signin`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ id, password })
            });
            const data = await res.json();
            managerToken = data.manager_token;
            document.getElementById("manager_token").textContent = managerToken;
        }

        async function getManagerInfo() {
            const res = await fetch(`${BASE_URL}/manager/Info`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ token: managerToken })
            });
            const data = await res.json();
            document.getElementById("manager_info").textContent = JSON.stringify(data, null, 2);
        }

        async function memberSignup() {
            const form = new FormData();
            form.append("id", document.getElementById("member_id").value);
            form.append("sex", document.getElementById("member_sex").value);
            form.append("name", document.getElementById("member_name").value);
            form.append("birthdate", document.getElementById("member_birthdate").value);
            form.append("profile_image_file", document.getElementById("member_img").files[0]);
            form.append("managerToken", managerToken);

            const res = await fetch(`${BASE_URL}/manager/Member_Signup`, { method: "POST", body: form });
            alert(await res.text());
        }

        async function getMemberList() {
            const res = await fetch(`${BASE_URL}/manager/MemberList`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ token: managerToken })
            });
            const data = await res.json();
            document.getElementById("member_list").textContent = JSON.stringify(data, null, 2);
        }

        async function getMemberImage() {
            const memberId = document.getElementById("img_member_id").value;
            const imageUrl = `${BASE_URL}/member/profile/${memberId}`;
            document.getElementById("member_image").src = imageUrl;
        }

        async function getManagerImage() {
            const managerId = document.getElementById("img_manager_id").value;
            const imageUrl = `${BASE_URL}/manager/profile/${managerId}`;
            document.getElementById("manager_image").src = imageUrl;
        }
    </script>
</body>
</html>
